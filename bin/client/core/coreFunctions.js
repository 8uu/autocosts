function isDef(e){return void 0!==e&&0!=e}function isObjDef(e){return null!==e&&"null"!=e&&"object"==typeof e&&!$.isEmptyObject(e)}function date_diff(e,t){var r,_,a,o;return r=t.getUTCMonth()+1,_=t.getUTCFullYear(),a=e.getUTCMonth()+1,!((o=e.getUTCFullYear())>_)&&(!(o===_&&a>r)&&(r>=a?12*(_-o)+(r-a):12*(_-o-1)+(r+12-a)))}function calculateMonthlyDepreciation(e,t,r){return(e-t)/r}function calculateInsuranceMonthlyValue(e,t){var r;switch(e){case"mensal":r=Number(t);break;case"trimestral":r=t/3;break;case"semestral":r=t/6;break;case"anual":r=t/12}return r}function calculateInterestsMonthlyValue(e,t,r,_,a,o){var i={total_interests:0,period:0,monthly_costs:0};if("true"==e){var n=parseFloat(r);i.period=n;var s=n*parseFloat(_)+parseFloat(a)-parseFloat(t);i.total_interests=s,s<0&&(s=0),i.monthly_costs=o>=n?s/o:parseFloat(s/n)}else i.total_interests=0,i.period=0,i.monthly_costs=0;return i}function calculateMonthlyInspection(e,t,r){return e>0?e*t/r:0}function calculateMonthlyTaxes(e){return parseFloat(e)/12}function calculateMonthlyFuel(e,t,r,_,a,o,i,n,s,c,p,l){var d={monthly_cost:0,distance_per_month:0};switch(e){case"km":var u,m=convert_to_fuel_eff_l100km(t,l.fuel_efficiency_std),h=convert_to_fuel_price_CURRpLitre(r,l.fuel_price_volume_std);if("false"==_){switch(a){case"1":u=parseInt(o);break;case"2":u=parseInt(o)/2;break;case"3":u=parseInt(o)/3;break;case"4":u=parseInt(o)/6;break;case"5":u=parseInt(o)/12}d.distance_per_month=u;var y=convert_std_dist_to_km(u,l.distance_std);d.monthly_cost=m*y*h/100}else{var f=convert_std_dist_to_km(i,l.distance_std),v=convert_std_dist_to_km(n,l.distance_std),k=(2*f*parseInt(s,10)+v)*(30.4375/7);d.monthly_cost=m*k*h/100,d.distance_per_month=convert_km_to_std_dist(k,l.distance_std)}break;case"euros":var w;switch(c){case"1":w=parseFloat(p);break;case"2":w=parseFloat(p)/2;break;case"3":w=parseFloat(p)/3;break;case"4":w=parseFloat(p)/6;break;case"5":w=parseFloat(p)/12}d.monthly_cost=w,d.distance_per_month=void 0}return d}function calculateMonthlyMaintenance(e){return parseFloat(e)/12}function calculateMonthlyRepairsAndImprovements(e){return parseFloat(e)/12}function calculateMonthlyParking(e){return parseFloat(e)}function calculateMonthlyTolls(e,t,r,_,a){if("false"!=e)return _*a;switch(t){case"1":return parseFloat(r);case"2":return parseFloat(r)/2;case"3":return parseFloat(r)/3;case"4":return parseFloat(r)/6;case"5":return parseFloat(r)/12}}function calculateMonthlyFines(e,t){switch(e){case"1":return parseFloat(t);case"2":return parseFloat(t)/2;case"3":return parseFloat(t)/3;case"4":return parseFloat(t)/6;case"5":return parseFloat(t)/12}return-1}function calculateMonthlyWashing(e,t){switch(e){case"1":return parseFloat(t);case"2":return parseFloat(t)/2;case"3":return parseFloat(t)/3;case"4":return parseFloat(t)/6;case"5":return parseFloat(t)/12}return-1}function calculate_costs(e,t,r,_){var a,o={depreciation:0,insurance:0,credit:0,inspection:0,car_tax:0,fuel:0,maintenance:0,repairs_improv:0,parking:0,tolls:0,fines:0,washing:0},i=new Date,n=date_diff(new Date(e.acquisitionYear,e.acquisitionMonth-1),i);0!=n&&(o.depreciation=calculateMonthlyDepreciation(e.auto_initial_cost,e.auto_final_cost,n)),o.insurance=calculateInsuranceMonthlyValue(e.insurance_type,e.insurance_value);var s=calculateInterestsMonthlyValue(e.cred_auto_s_n,e.credit_amount,e.credit_period,e.credit_value_p_month,e.credit_residual_value,n);o.credit=s.monthly_costs,o.inspection=calculateMonthlyInspection(e.nmr_times_inspec,e.inspec_price,n),o.car_tax=calculateMonthlyTaxes(e.car_tax);var c=calculateMonthlyFuel(t.type_calc_fuel,t.fuel_efficiency,t.fuel_price,t.take_car_to_job,t.fuel_period_distance,t.distance,t.distance_home2job,t.distance_weekend,t.days_p_week,t.fuel_period_money,t.fuel_money,_);o.fuel=c.monthly_cost,a=c.distance_per_month,o.maintenance=calculateMonthlyMaintenance(t.maintenance),o.repairs_improv=calculateMonthlyRepairsAndImprovements(t.repairs),o.parking=calculateMonthlyParking(t.parking),o.tolls=calculateMonthlyTolls(t.type_calc_tolls,t.tolls_select,t.tolls,t.price_tolls_p_day,t.tolls_days_p_month),o.fines=calculateMonthlyFines(t.fines_select,t.fines),o.washing=calculateMonthlyWashing(t.washing_select,t.washing);var p,l,d,u,m,h,y,f,v=o.insurance+o.depreciation+o.credit+o.inspection+.5*o.maintenance+o.car_tax,k=o.fuel+.5*o.maintenance+o.repairs_improv+o.parking+o.tolls+o.fines+o.washing,w=o.insurance+o.fuel+o.depreciation+o.credit+o.inspection+o.maintenance+o.repairs_improv+o.car_tax+o.parking+o.tolls+o.fines+o.washing,b=12*w;if(r.IsAlternativeToCarCosts){(p={ptcosts_carcosts_ratio_threshold:.9,other_pt_ratio_threshold:.6,taxi_price_per_km:_.taxi_price,display_pt:function(){return r.monthly_pass_cost*r.n_pess_familia<this.ptcosts_carcosts_ratio_threshold*w&&0!=r.monthly_pass_cost},total_price_pt:0,total_altern:0,pt_carcost_ratio:0,taxi_cost:0,km_by_taxi:0,display_other_pt:!1,other_pt:0}).display_pt()&&(p.total_price_pt=r.monthly_pass_cost*r.n_pess_familia,p.total_altern=p.total_price_pt,p.pt_carcost_ratio=p.total_price_pt/w,p.pt_carcost_ratio>p.other_pt_ratio_threshold?(p.display_other_pt=!1,p.taxi_cost=w-p.total_price_pt,p.km_by_taxi=p.taxi_cost/p.taxi_price_per_km,p.total_altern+=p.taxi_cost):(p.display_other_pt=!0,p.taxi_cost=w*(1-p.pt_carcost_ratio)/2,p.km_by_taxi=p.taxi_cost/p.taxi_price_per_km,p.other_pt=w*(1-p.pt_carcost_ratio)/2,p.total_altern+=p.taxi_cost+p.other_pt))}if(r.IsFinancialEffort){switch(l={income:0,income_per_year:0,income_per_type:0,income_hours_per_week:0,aver_income_per_month:0,aver_income_per_hour:0,time_hours_per_week:36,time_month_per_year:11,aver_work_time_per_m:0,work_hours_per_y:0,total_costs_year:b,hours_per_year_to_afford_car:0,month_per_year_to_afford_car:0,days_car_paid:0},r.income_type){case"year":l.income=r.income_per_year,l.income_per_year=1*l.income;break;case"month":l.income=r.income_per_month,l.income_per_type=r.income_months_per_year,l.income_per_year=l.income*l.income_per_type;break;case"week":l.income=r.income_per_week,l.income_per_type=r.income_weeks_per_year,l.income_per_year=l.income*l.income_per_type;break;case"hour":l.income=r.income_per_hour,l.income_hours_per_week=r.income_hours_per_week,l.income_per_type=r.income_hour_weeks_per_year,l.income_per_year=l.income*l.income_hours_per_week*l.income_per_type}l.aver_income_per_month=l.income_per_year/12,"hour"!=r.income_type&&("true"==r.is_working_time&&(l.time_hours_per_week=r.time_hours_per_week,l.time_month_per_year=r.time_month_per_year),l.aver_work_time_per_m=365.25/7*l.time_hours_per_week*l.time_month_per_year/12/12,l.work_hours_per_y=365.25/7*l.time_hours_per_week*l.time_month_per_year/12);var g,F,I=r.income_type,M=11,j=36;switch("true"==r.is_working_time&&(M=parseInt(r.time_month_per_year),j=parseInt(r.time_hours_per_week)),g=365.25/7*M/12*j,I){case"year":F=parseInt(r.income_per_year)/g;break;case"month":F=parseInt(r.income_per_month)*parseInt(r.income_months_per_year)/g;break;case"week":F=parseInt(r.income_per_week)*parseInt(r.income_weeks_per_year)/g;break;case"hour":F=parseInt(r.income_per_hour)}l.aver_income_per_hour=F,l.hours_per_year_to_afford_car=b/l.aver_income_per_hour,l.month_per_year_to_afford_car=b/l.income_per_year*12,l.days_car_paid=b/l.income_per_year*365.25}if(r.IsFinancialEffort||r.IsAlternativeToCarCosts){if(d={drive_per_year:0,drive_to_work_days_per_week:0,dist_home_job:0,journey_weekend:0,aver_drive_per_week:0,fuel_period_km:r.period_km},"euros"==t.type_calc_fuel)if("true"==r.drive_to_work)d.drive_to_work_days_per_week=r.drive_to_work_days_per_week,d.dist_home_job=parseInt(r.dist_home_job),d.journey_weekend=parseInt(r.journey_weekend),d.aver_drive_per_week=2*d.drive_to_work_days_per_week*d.dist_home_job+d.journey_weekend,a=365.25/7*d.aver_drive_per_week/12,d.drive_per_year=365.25/7*d.aver_drive_per_week;else{switch(d.fuel_period_km){case"1":a=parseInt(r.dist_per_time_period);break;case"2":a=r.dist_per_time_period/2;break;case"3":a=r.dist_per_time_period/3;break;case"4":a=r.dist_per_time_period/6;break;case"5":a=r.dist_per_time_period/12}d.drive_per_year=12*a}else"true"==t.take_car_to_job&&(d.drive_to_work_days_per_week=t.days_p_week,d.dist_home_job=parseInt(t.distance_home2job),d.journey_weekend=parseInt(t.distance_weekend),d.aver_drive_per_week=2*d.drive_to_work_days_per_week*d.dist_home_job+d.journey_weekend),d.drive_per_year=12*a;u={time_home_job:0,time_weekend:0,min_drive_per_week:0,min_drive_per_day:0,days_drive_per_month:0,hours_drive_per_month:0,hours_drive_per_year:0},"true"==t.take_car_to_job||"true"==r.drive_to_work?(u.time_home_job=parseInt(r.time_home_job),u.time_weekend=parseInt(r.time_weekend),u.min_drive_per_week=2*u.time_home_job*d.drive_to_work_days_per_week+u.time_weekend,u.hours_drive_per_month=365.25/7/12*u.min_drive_per_week/60):(u.min_drive_per_day=parseInt(r.min_drive_per_day),u.days_drive_per_month=parseInt(r.days_drive_per_month),u.hours_drive_per_month=u.min_drive_per_day*u.days_drive_per_month/60),u.hours_drive_per_year=12*u.hours_drive_per_month,m=d.drive_per_year/u.hours_drive_per_year,r.IsFinancialEffort&&(h=d.drive_per_year/(u.hours_drive_per_year+l.hours_per_year_to_afford_car))}isDef(a)?(y=k/a,f=w/a):(y=void 0,f=void 0);var x={monthly_costs:o,public_transports:void 0,alternative_to_car_costs_calculated:!1,fin_effort:void 0,fin_effort_calculated:!1,driving_distance:void 0,driving_distance_calculated:!1,time_spent_driving:void 0,time_spent_driving_calculated:!1,external_costs:{handbook_extern_URL:"http://ec.europa.eu/transport/themes/sustainable/doc/2008_costs_handbook.pdf",polution:.005,ghg:.007,noise:.004,fatalities:.03,congestion:.1,infrastr:.001,total_exter:function(){return(this.polution+this.ghg+this.noise+this.fatalities+this.congestion+this.infrastr)*a},total_costs:function(){return this.total_exter()}},distance_per_month:a,age_months:n,month_cred:s.period,total_interests:s.total_interests,fuel_period_km:t.fuel_period_distance,fuel_cost_period:t.fuel_period_money,tolls_period:t.tolls_select,fines_period:t.fines_select,washing_period:t.washing_select,total_standing_costs_month:v,total_running_costs_month:k,total_costs_month:w,total_costs_year:b,running_costs_p_unit_distance:y,total_costs_p_unit_distance:f,kinetic_speed:void 0,virtual_speed:void 0};return r.IsAlternativeToCarCosts&&(x.alternative_to_car_costs_calculated=!0,x.public_transports=p),r.IsFinancialEffort&&(x.fin_effort_calculated=!0,x.fin_effort=l,x.virtual_speed=h),(r.IsAlternativeToCarCosts||r.IsFinancialEffort)&&(x.driving_distance=d,x.driving_distance_calculated=!0,x.time_spent_driving=u,x.time_spent_driving_calculated=!0,x.kinetic_speed=m),x}function get_uber(e,t,r){if(!t.alternative_to_car_costs_calculated)return!1;if(!isDef(t.distance_per_month))return!1;if(!isObjDef(e))return!1;if(e.currency_code.toUpperCase()!=r.currency.toUpperCase())return!1;var _,a,o,i=e.distance_unit.toLowerCase();if(1==r.distance_std){if("km"!=i)return!1}else{if(2!=r.distance_std)return!1;if("mile"!=i&&"miles"!=i&&"mi"!=i&&"mi."!=i)return!1}var n=1*e.cost_per_distance,s=1*e.cost_per_minute,c=t.public_transports.total_price_pt,p=t.distance_per_month,l=t.total_costs_p_unit_distance,d=t.total_costs_month,u=t.time_spent_driving.hours_drive_per_month,m=60*t.time_spent_driving.hours_drive_per_month;if(tuc=n*p+s*m,tuc<d)_=1,o=d-tuc;else{if(_=2,!t.public_transports.display_pt())return!1;if((o=d-c)<0)return!1;if((a=o/(n-s*t.kinetic_speed/60))<0)return!1}return{result_type:_,ucd:n,ucm:s,tuc:tuc,dpm:p,hdpm:u,mdpm:m,tcpd:l,tcpm:d,dist_uber:a,tcpt:c,delta:o}}